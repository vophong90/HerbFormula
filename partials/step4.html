<h2 class="text-2xl font-semibold mb-4">🧪 Bước 4: Gợi ý toa thuốc</h2>

<!-- 4.1 Thông tin ngữ cảnh -->
<div class="grid md:grid-cols-2 gap-4 mb-6">
  <div class="bg-white border rounded p-3">
    <div class="font-semibold mb-2">🏷️ Hội chứng đang xét (từ Bước 3)</div>
    <input id="b4-syndrome" type="text" class="w-full border rounded px-3 py-2" readonly>
  </div>
  <div class="bg-white border rounded p-3">
    <div class="font-semibold mb-2">🔝 Triệu chứng ưu tiên (VAS cao nhất, từ Bước 2)</div>
    <input id="b4-priority-symptom" type="text" class="w-full border rounded px-3 py-2" readonly>
  </div>
</div>

<!-- 4.2 Khung 6S (rút gọn) -->
<div class="grid md:grid-cols-3 gap-4 mb-6">
  <div class="bg-white border rounded p-3">
    <div class="font-semibold mb-2">S1 — Source (cơ chế/nguyên nhân)</div>
    <div class="text-sm text-gray-600 mb-2">Gợi ý vị thuốc theo cơ chế hội chứng.</div>
    <div class="flex gap-2 mb-2">
      <button id="b4-btn-s1" class="bg-emerald-600 text-white px-3 py-2 rounded">🤖 Gợi ý S1</button>
      <button id="b4-btn-s1-clear" class="bg-gray-600 text-white px-3 py-2 rounded">🧹 Xoá</button>
    </div>
    <ul id="b4-s1-list" class="list-disc list-inside text-sm space-y-1"></ul>
  </div>

  <div class="bg-white border rounded p-3">
    <div class="font-semibold mb-2">S2 — Symptom (theo triệu chứng)</div>
    <div class="text-sm text-gray-600 mb-2">Gợi ý vị thuốc theo triệu chứng ưu tiên.</div>
    <div class="flex gap-2 mb-2">
      <button id="b4-btn-s2" class="bg-indigo-600 text-white px-3 py-2 rounded">🤖 Gợi ý S2</button>
      <button id="b4-btn-s2-clear" class="bg-gray-600 text-white px-3 py-2 rounded">🧹 Xoá</button>
    </div>
    <ul id="b4-s2-list" class="list-disc list-inside text-sm space-y-1"></ul>
  </div>

  <div class="bg-white border rounded p-3">
    <div class="font-semibold mb-2">S3 — Secondary (phòng tái phát / hỗ trợ)</div>
    <div class="text-sm text-gray-600 mb-2">Bổ sung vị thuốc hỗ trợ, điều hoà.</div>
    <div class="flex gap-2 mb-2">
      <button id="b4-btn-s3" class="bg-sky-600 text-white px-3 py-2 rounded">➕ Gợi ý S3</button>
      <button id="b4-btn-s3-clear" class="bg-gray-600 text-white px-3 py-2 rounded">🧹 Xoá</button>
    </div>
    <ul id="b4-s3-list" class="list-disc list-inside text-sm space-y-1"></ul>
  </div>
</div>

<!-- 4.3 Toa đề xuất (ghép từ 6S) -->
<div class="bg-white border rounded p-4 mb-4">
  <div class="flex items-center justify-between mb-3">
    <h3 class="font-semibold">🧾 Toa đề xuất (có thể chỉnh liều)</h3>
    <div class="space-x-2">
      <button id="b4-btn-merge" class="bg-green-600 text-white px-3 py-2 rounded">🔗 Ghép 6S → Toa</button>
      <button id="b4-btn-clear-final" class="bg-gray-600 text-white px-3 py-2 rounded">🧹 Xoá toa</button>
    </div>
  </div>

  <div class="overflow-x-auto">
    <table class="w-full text-sm border">
      <thead class="bg-gray-100">
        <tr>
          <th class="border px-2 py-1 text-left">Vị thuốc</th>
          <th class="border px-2 py-1">Liều (g)</th>
          <th class="border px-2 py-1">Ghi chú</th>
          <th class="border px-2 py-1">Xoá</th>
        </tr>
      </thead>
      <tbody id="b4-final-tbody"></tbody>
    </table>
  </div>

  <div class="mt-3 flex gap-2">
    <input id="b4-custom-herb" placeholder="Thêm vị thuốc..." class="border rounded px-2 py-1 flex-1">
    <input id="b4-custom-dose" type="number" step="0.5" placeholder="Liều g" class="border rounded px-2 py-1 w-28">
    <button id="b4-btn-add" class="bg-blue-600 text-white px-3 py-2 rounded">➕ Thêm</button>
  </div>
</div>

<!-- 4.4 Điều hướng -->
<div class="mt-6 flex justify-between">
  <button id="b4-btn-back3" class="bg-gray-500 text-white px-4 py-2 rounded">⬅ Quay lại Bước 3</button>
  <div class="space-x-2">
    <button id="b4-btn-save" class="bg-green-600 text-white px-4 py-2 rounded">💾 Lưu</button>
    <button id="b4-btn-next5" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">Tiếp tục ➡ Bước 5</button>
  </div>
</div>
